using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using System.IO.Ports;

public class PlayerShoot : MonoBehaviour
{
    SerialPort puerto = new SerialPort("COM7", 9600);

    public float speed = 3;
    public Bullet bulletprefab;
    private bool bulletActive;

    private bool playerShoot = false;

    void Start()
    {
        puerto.ReadTimeout = 40;
        puerto.Open();
    }

    private void Update()
    {
        string Lectura = "";
        if (puerto.IsOpen)
        {
            Lectura = puerto.ReadLine();
            Debug.Log(Lectura);
            if (Lectura.Equals("PRESS"))
            {
                Shoot();
                playerShoot = true;
            }
        }
        else
            Debug.Log("Puerto cerrado");
        //try
        //{
        //} catch(System.Exception ex1)
        //{
        //    ex1 = new System.Exception();
        //}

    }

   

    private void Shoot()
    {
        if (!bulletActive)
        {
            Bullet bullet = Instantiate(this.bulletprefab, this.transform.position, Quaternion.identity);
            bullet.destroyed += BulletDestroyed;
            bulletActive = true;
        }
    }

    private void BulletDestroyed()
    {
        bulletActive = false;
    }

    private void FixedUpdate()
    {
        Debug.Log("Player shoot = " + playerShoot);
    }

}
